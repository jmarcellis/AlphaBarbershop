var _imgInterval,_getTitle=function(a){if(a.data&&a.data.title!==undefined){return a.data.title}var b=mfp.st.image.titleSrc;if(b){if($.isFunction(b)){return b.call(mfp,a)}else{if(a.el){return a.el.attr(b)||""}}}return""};$.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:true,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var b=mfp.st.image,a=".image";mfp.types.push("image");_mfpOn(OPEN_EVENT+a,function(){if(mfp.currItem.type==="image"&&b.cursor){_body.addClass(b.cursor)}});_mfpOn(CLOSE_EVENT+a,function(){if(b.cursor){_body.removeClass(b.cursor)}_window.off("resize"+EVENT_NS)});_mfpOn("Resize"+a,mfp.resizeImage);if(mfp.isLowIE){_mfpOn("AfterChange",mfp.resizeImage)}},resizeImage:function(){var b=mfp.currItem;if(!b||!b.img){return}if(mfp.st.image.verticalFit){var a=0;if(mfp.isLowIE){a=parseInt(b.img.css("padding-top"),10)+parseInt(b.img.css("padding-bottom"),10)}b.img.css("max-height",mfp.wH-a)}},_onImageHasSize:function(a){if(a.img){a.hasSize=true;if(_imgInterval){clearInterval(_imgInterval)}a.isCheckingImgSize=false;_mfpTrigger("ImageHasSize",a);if(a.imgHidden){if(mfp.content){mfp.content.removeClass("mfp-loading")}a.imgHidden=false}}},findImageSize:function(d){var a=0,b=d.img[0],c=function(e){if(_imgInterval){clearInterval(_imgInterval)}_imgInterval=setInterval(function(){if(b.naturalWidth>0){mfp._onImageHasSize(d);return}if(a>200){clearInterval(_imgInterval)}a++;if(a===3){c(10)}else{if(a===40){c(50)}else{if(a===100){c(500)}}}},e)};c(1)},getImage:function(g,d){var f=0,h=function(){if(g){if(g.img[0].complete){g.img.off(".mfploader");if(g===mfp.currItem){mfp._onImageHasSize(g);mfp.updateStatus("ready")}g.hasSize=true;g.loaded=true;_mfpTrigger("ImageLoadComplete")}else{f++;if(f<200){setTimeout(h,100)}else{a()}}}},a=function(){if(g){g.img.off(".mfploader");if(g===mfp.currItem){mfp._onImageHasSize(g);mfp.updateStatus("error",e.tError.replace("%url%",g.src))}g.hasSize=true;g.loaded=true;g.loadError=true}},e=mfp.st.image;var c=d.find(".mfp-img");if(c.length){var b=document.createElement("img");b.className="mfp-img";g.img=$(b).on("load.mfploader",h).on("error.mfploader",a);b.src=g.src;if(c.is("img")){g.img=g.img.clone()}b=g.img[0];if(b.naturalWidth>0){g.hasSize=true}else{if(!b.width){g.hasSize=false}}}mfp._parseMarkup(d,{title:_getTitle(g),img_replaceWith:g.img},g);mfp.resizeImage();if(g.hasSize){if(_imgInterval){clearInterval(_imgInterval)}if(g.loadError){d.addClass("mfp-loading");mfp.updateStatus("error",e.tError.replace("%url%",g.src))}else{d.removeClass("mfp-loading");mfp.updateStatus("ready")}return d}mfp.updateStatus("loading");g.loading=true;if(!g.hasSize){g.imgHidden=true;d.addClass("mfp-loading");mfp.findImageSize(g)}return d}}});