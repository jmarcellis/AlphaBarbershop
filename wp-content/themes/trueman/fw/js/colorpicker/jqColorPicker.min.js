(function(i,C,l){var F=i(document),c,j,m,u,E="",k,p,A,o,z,g,D,b="touchmove mousemove pointermove",I="touchend mouseup pointerup",B=false,y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(J){J()},d='<div class="cp-color-picker"><div class="cp-z-slider"><div class="cp-z-cursor"></div></div><div class="cp-xy-slider"><div class="cp-white"></div><div class="cp-xy-cursor"></div></div><div class="cp-alpha"><div class="cp-alpha-cursor"></div></div></div>',s=".cp-color-picker{position:absolute;overflow:hidden;padding:6px 6px 0;background-color:#444;color:#bbb;font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:400;cursor:default;border-radius:5px}.cp-color-picker>div{position:relative;overflow:hidden}.cp-xy-slider{float:left;height:128px;width:128px;margin-bottom:6px;background:linear-gradient(to right,#FFF,rgba(255,255,255,0))}.cp-white{height:100%;width:100%;background:linear-gradient(rgba(0,0,0,0),#000)}.cp-xy-cursor{position:absolute;top:0;width:10px;height:10px;margin:-5px;border:1px solid #fff;border-radius:100%;box-sizing:border-box}.cp-z-slider{float:right;margin-left:6px;height:128px;width:20px;background:linear-gradient(red 0,#f0f 17%,#00f 33%,#0ff 50%,#0f0 67%,#ff0 83%,red 100%)}.cp-z-cursor{position:absolute;margin-top:-4px;width:100%;border:4px solid #fff;border-color:transparent #fff;box-sizing:border-box}.cp-alpha{clear:both;width:100%;height:16px;margin:6px 0;background:linear-gradient(to right,#444,rgba(0,0,0,0))}.cp-alpha-cursor{position:absolute;margin-left:-4px;height:100%;border:4px solid #fff;border-color:#fff transparent;box-sizing:border-box}",a=function(J){m=this.color=new C(J);u=m.options};a.prototype={render:f,toggle:w};function n(J){return J.value||J.getAttribute("value")||i(J).css("background-color")||"#fff"}function x(J){return J.originalEvent.touches?J.originalEvent.touches[0]:J}function t(J){return i(J.find(u.doRender)[0]||J[0])}function w(K){var L=i(this),J=L.offset(),M=i(window),N=u.gap;if(K){k=t(L);j.$trigger=L;(p||r()).css({left:(p[0]._left=J.left)-((p[0]._left=p[0]._left+p[0]._width-(M.scrollLeft()+M.width()))+N>0?p[0]._left+N:0),top:(p[0]._top=J.top+L.outerHeight())-((p[0]._top=p[0]._top+p[0]._height-(M.scrollTop()+M.height()))+N>0?p[0]._top+N:0)}).show(u.animationSpeed,function(){if(K===true){return}g._width=g.width();A._width=A.width();A._height=A.height();m.setColor(n(k[0]));f(true)})}else{if(i(p).is(":visible")){i(p).hide(u.animationSpeed,function(){k.blur();j.$trigger=null;f(false)})}}}function r(){i("head").append('<style type="text/css">'+(u.css||s)+(u.cssAddon||"")+"</style>");return j.$UI=p=i(d).css({margin:u.margin}).appendTo("body").show(0,function(){var J=i(this);B=u.GPU&&J.css("perspective")!==l;A=i(".cp-xy-slider",this);o=i(".cp-xy-cursor",this);z=i(".cp-z-cursor",this);g=i(".cp-alpha",this).toggle(!!u.opacity);D=i(".cp-alpha-cursor",this);u.buildCallback.call(j,J);J.prepend("<div>").children().eq(0).css("width",J.children().eq(0).width());this._width=this.offsetWidth;this._height=this.offsetHeight}).hide().on("touchstart mousedown pointerdown",".cp-xy-slider,.cp-z-slider,.cp-alpha",H)}function H(K){var J=this.className.replace(/cp-(.*?)(?:\s*|$)/,"$1").replace("-","_");K.preventDefault&&K.preventDefault();K.returnValue=false;k._offset=i(this).offset();(J=J==="xy_slider"?v:J==="z_slider"?q:h)(K);F.on(I,e).on(b,J)}function e(J){F.off(b).off(I)}function v(K){var L=x(K),J=L.pageX-k._offset.left,M=L.pageY-k._offset.top;m.setColor({s:J/A._width*100,v:100-(M/A._height*100)},"hsv");f()}function q(K){var L=x(K).pageY-k._offset.top,J=m.colors.hsv;m.setColor({h:360-(L/A._height*360)},"hsv");f()}function h(K){var J=x(K).pageX-k._offset.left,L=J/g._width;m.setColor({},"rgb",L>1?1:L<0?0:L);f()}function f(J){var U=m.colors,M=U.hueRGB,O=U.RND.rgb,V=U.RND.hsl,L="#222",Q="#ddd",S=k.data("colorMode"),T=U.alpha!==1,R=Math.round(U.alpha*100)/100,Z=O.r+", "+O.g+", "+O.b,X=(S==="HEX"&&!T?"#"+U.HEX:S==="rgb"||(S==="HEX"&&T)?(!T?"rgb("+Z+")":"rgba("+Z+", "+R+")"):("hsl"+(T?"a(":"(")+V.h+", "+V.s+"%, "+V.l+"%"+(T?", "+R:"")+")")),ab=U.HUELuminance>0.22?L:Q,N=U.rgbaMixBlack.luminance>0.22?L:Q,aa=(1-U.hsv.h)*A._height,Y=U.hsv.s*A._width,W=(1-U.hsv.v)*A._height,ac=R*g._width,ad=B?"translate3d":"",K=k.val(),P=k[0].hasAttribute("value")&&K===""&&J!==l;A._css={backgroundColor:"rgb("+M.r+","+M.g+","+M.b+")"};o._css={transform:ad+"("+Y+"px, "+W+"px, 0)",left:!B?Y:"",top:!B?W:"",borderColor:U.RGBLuminance>0.22?L:Q};z._css={transform:ad+"(0, "+aa+"px, 0)",top:!B?aa:"",borderColor:"transparent "+ab};g._css={backgroundColor:"rgb("+Z+")"};D._css={transform:ad+"("+ac+"px, 0, 0)",left:!B?ac:"",borderColor:N+" transparent"};k._css={backgroundColor:P?"":X,color:P?"":U.rgbaMixBGMixCustom.luminance>0.22?L:Q};k.text=P?"":K!==X?X:"";J!==l?G(J):y(G)}function G(J){A.css(A._css);o.css(o._css);z.css(z._css);g.css(g._css);D.css(D._css);if(J!==false){u.doRender&&k.css(k._css);k.text&&k.val(k.text)}u.renderCallback.call(j,k,typeof J==="boolean"?J:l)}i.fn.colorPicker=function(J){var K=function(){};J=i.extend({animationSpeed:150,GPU:true,doRender:true,customBG:"#FFF",opacity:true,renderCallback:K,buildCallback:K,body:document.body,scrollResize:true,gap:4},J);!j&&J.scrollResize&&i(window).on("resize scroll",function(){if(j.$trigger){j.toggle.call(j.$trigger[0],true)}});c=c?c.add(this):this;c.colorPicker=j||(j=new a(J));E+=(E?", ":"")+this.selector;i(J.body).off(".a").on("touchstart.a mousedown.a pointerdown.a",function(M){var L=i(M.target);if(i.inArray(L.closest(E)[0],c)===-1&&!L.closest(p).length){w()}}).on("focus.a click.a",E,w).on("change.a",E,function(L){var M=this.value;m.setColor(M||"#FFF");if(!M){w();this.value="";i(L.target).css("backgroundColor","#fff")}else{c.colorPicker.render(true)}});return this.each(function(){var M=n(this),N=M.split("("),L=t(i(this));L.data("colorMode",N[1]?N[0].substr(0,3):"HEX").attr("readonly",u.preventFocus);J.doRender&&L.css({"background-color":M,color:function(){return m.setColor(M).rgbaMixBGMixCustom.luminance>0.22?"#222":"#ddd"}})})}})(jQuery,Colors);